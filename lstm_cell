import numpy as np

def lstm_cell_forward(xt,a_prev,c_prev,parameters):
    
    
    Wf=parameters["Wf"]
    bf=parameters["bf"]
    Wi=parameters["Wi"]
    bi=parameters["bi"]
    Wc=parameters["Wc"]
    bc=parameters["bc"]
    Wo=parameters["Wo"]
    bo=parameters["bo"]
    Wy=parameters["Wy"]
    by=parameters["by"]
    
    
    n_x,m=xt.shape
    n_y,n_a=Wy.shape
    
    concat=np.concatenate([a_prev,x])
    
    
    ft=sigmoid(np.dot(Wf,concat)+bf)#forget gate
    it=sigmoid(np.dot(Wi,concat)+bi)#update gate
    cct=tanh(np.dot(Wc,concat)+bc) #candidate c
    c_next=c_prev*ft+cct*it#c
    ot=sigmoid(np.dot(Wo,concat)+bo)#output gate
    
    a_next=ot*(np.tanh(c_next))
    yt_pred=softmax(np.dot(Wy,a_next)+by)
    
    cache = (a_next, c_next, a_prev, c_prev, ft, it, cct, ot, xt, parameters)
    
    return a_next,c_next,yt_pred,cache
